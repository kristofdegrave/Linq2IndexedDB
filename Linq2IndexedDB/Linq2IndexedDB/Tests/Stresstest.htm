<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
        <style type="text/css">
            #txtLog {
                height: 200px;
                width: 1000px;
            }
        </style>
        <script src="../Scripts/jquery-1.7.2.js" type="text/javascript"> </script>
        <script type="text/javascript" src="../Scripts/indexeddb.shim.js"> </script>
        <script src="../Scripts/Linq2IndexedDB.js" type="text/javascript"> </script>
        <script type="text/javascript">
            $(function () {
                var applicationVersion = 1;
                var indexedDBName = "inserts";
                var databaseDefinition = [{
                    version: 1,
                    objectStores: [{ name: "insert", objectStoreOptions: { autoIncrement: true, keyPath: "Id" } }]
                }];
                
                var dbConfig = new Object();
                dbConfig.version = applicationVersion;
                dbConfig.definition = databaseDefinition;

                var db = window.linq2indexedDB(indexedDBName, dbConfig, true);

                db.deleteDatabase().then(function () {
                    $("#txtLog").val("");
                    for (var i = 0; i < 10000; i++) {
                        db.linq.from("insert").insert({ data: "data" }).then(function (e) {
                            var tekst = $("#txtLog").val();
                            tekst += "Key: " + e.key + "\n\r";
                            $("#txtLog").val(tekst);
                        }, function (e) {
                            var d = e;
                        });
                    }
                });
            });
        </script>
    </head>
    <body>
        <textarea id="txtLog"></textarea>
    </body>
</html>