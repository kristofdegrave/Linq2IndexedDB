<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <style type="text/css">
        #txtLog {
            height: 200px;
            width: 1000px;
        }
    </style>
    <script src="../Scripts/jquery-1.7.2.js" type="text/javascript"></script>
    <script type="text/javascript" src="../Scripts/indexeddb.shim.js"></script>
    <script src="../Scripts/Linq2IndexedDB.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            linq2indexedDB.prototype.linq.addFilter("myFilter", function (data/*, filter*/) {
                return data.Age > 3;
            }
            , function (callback, queryBuilder, filterMetaData) {
                return function() {
                    return callback(queryBuilder, filterMetaData);
                };
            });

            var db = $.linq2indexedDB("test", null, true);
            db.deleteDatabase().then(function () {
                db.linq.from("person").insert({ Name: "test1", Firstname: "test1", Age: 1 });
                db.linq.from("person").insert({ Name: "test2", Firstname: "test2", Age: 2 });
                db.linq.from("person").insert({ Name: "test3", Firstname: "test3", Age: 3 });
                db.linq.from("person").insert({ Name: "test4", Firstname: "test4", Age: 4 });
                db.linq.from("person").insert({ Name: "test11", Firstname: "test11", Age: 11 });


                //db.linq.from("person").where("Name").equals("test1").select(["Name", "Firstname"]).then(function () { }, function () { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                //db.linq.from("person").where("Age").smallerThan(3).select(["Name", "Firstname", "Age"]).then(function () { }, function () { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + " Age: " + data["Age"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                //db.linq.from("person").where("Age").smallerThan(3).and("Name").like("test").select(["Name", "Firstname"]).then(function () { }, function (error) { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                //db.linq.from("person").where("Name").inArray(["test1", "test2"]).select(["Name", "Firstname"]).then(function () { }, function () { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                //db.linq.from("person").where("Name").like("test1").select(["Name", "Firstname"]).then(function () { }, function () { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                //db.linq.from("person").where("Name").equals("test1").or("Name").equals("test2").select(["Name", "Firstname"]).then(function () { }, function () { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                //db.linq.from("person").where("Name").equals("test1").or("Name").not().equals("test2").select(["Name", "Firstname"]).then(function () { }, function () { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                //db.linq.from("person").where("Name").myFilter().select(["Name", "Firstname"]).then(function () { }, function () { }, function (data) {
                //    var tekst = $("#txtLog").val();
                //    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                //    $("#txtLog").val(tekst);
                //});

                db.linq.from("person").where(function (data) {
                    return data.Age > 3;
                }).and(function (data) {
                    return data.Age < 10;
                }).select(["Name", "Firstname"]).then(function () { }, function () { }, function (data) {
                    var tekst = $("#txtLog").val();
                    tekst += "Name: " + data["Name"] + " Firstname: " + data["Firstname"] + "\n\r";
                    $("#txtLog").val(tekst);
                });
            });
        });
    </script>
</head>
<body>
    <textarea id="txtLog"></textarea>
</body>
</html>
