<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="../Scripts/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="../Scripts/Linq2IndexedDB.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            var databaseDefinition = [{
                version: 1,
                objectStores: [{ name: "IdAuto", objectStoreOptions: { autoIncrement: true, keyPath: "Id" } },
                               { name: "Auto", objectStoreOptions: { autoIncrement: true } },
                               { name: "Id", objectStoreOptions: { autoIncrement: false, keyPath: "Id" } },
                               { name: "None", objectStoreOptions: { autoIncrement: false } }]
            }];

            var dbConfiguration = new Object();
            dbConfiguration.Name = "insertTest";
            dbConfiguration.version = 1;
            dbConfiguration.definition = databaseDefinition
            var db = $.linq2indexedDB("insertTest", dbConfiguration, true);
            db.deleteDatabase().then(function () {
                db.initialize().then(Initialized);
            });
            function Initialized() {
                db.linq.from("IdAuto").clear().then(function () {
                    db.linq.from("IdAuto").insert({ Name: "test1" }).then(function () { log("test1 successfull") }, function () { log("test1 failed") });
                    db.linq.from("IdAuto").insert({ Id: 12, Name: "test2" }).then(function () { log("test2 successfull") }, function () { log("test2 failed") });
                    db.linq.from("IdAuto").insert({ Name: "test3" }, 13).then(function () { log("test3 successfull") }, function () { log("test3 failed") });
                    db.linq.from("IdAuto").insert({ Id: 14, Name: "test4" }, 14).then(function () { log("test4 successfull") }, function () { log("test4 failed") });
                });

                db.linq.from("Auto").clear().then(function () {
                    db.linq.from("Auto").insert({ Name: "test11" }).then(function () { log("test11 successfull") }, function () { log("test11 failed") });
                    db.linq.from("Auto").insert({ Id: 12, Name: "test12" }).then(function () { log("test12 successfull") }, function () { log("test12 failed") });
                    db.linq.from("Auto").insert({ Name: "test13" }, 13).then(function () { log("test13 successfull") }, function () { log("test13 failed") });
                    db.linq.from("Auto").insert({ Id: 14, Name: "test14" }, 14).then(function () { log("test14 successfull") }, function () { log("test14 failed") });
                });

                db.linq.from("Id").clear().then(function () {
                    db.linq.from("Id").insert({ Name: "test21" }).then(function () { log("test21 successfull") }, function () { log("test21 failed") });
                    db.linq.from("Id").insert({ Id: 22, Name: "test22" }).then(function () { log("test22 successfull") }, function () { log("test22 failed") });
                    db.linq.from("Id").insert({ Name: "test23" }, 3).then(function () { log("test23 successfull") }, function () { log("test23 failed") });
                    db.linq.from("Id").insert({ Id: 24, Name: "test24" }, 24).then(function () { log("test24 successfull") }, function () { log("test24 failed") });
                });

                db.linq.from("None").clear().then(function () {
                    db.linq.from("None").insert({ Name: "test31" }).then(function () { log("test31 successfull") }, function () { log("test31 failed") });
                    db.linq.from("None").insert({ Id: 32, Name: "test32" }).then(function () { log("test32 successfull") }, function () { log("test32 failed") });
                    db.linq.from("None").insert({ Name: "test33" }, 33).then(function () { log("test33 successfull") }, function () { log("test33 failed") });
                    db.linq.from("None").insert({ Id: 34, Name: "test34" }, 34).then(function () { log("test34 successfull") }, function () { log("test34 failed") });
                });
            }

            function log(msg) {
                var tekst = $("#txtLog").val();
                tekst += msg + "\n\r";
                $("#txtLog").val(tekst);
            }
        });

        
    </script>
</head>
<body>
<textarea id="txtLog" rows="30" cols="150"></textarea>
</body>
</html>
